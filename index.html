<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Grocery Lists</title>
  <style>
    :root {
      --veggies-color: #4caf50;
      --grocery-color: #2196f3;
      --indian-color: #ff9800;
      --checked-color: #e9ecef;
      --master-check-color: #673ab7;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 15px;
      background-color: #f5f7fa;
      color: #333;
      font-size: 18px;
      padding-bottom: 80px;
      padding-top: 60px;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
      font-size: 1.3rem;
    }

    .table-container {
      margin-bottom: 20px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      overflow: hidden;
    }

    .table-header {
      padding: 15px;
      font-weight: bold;
      font-size: 1.1rem;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }

    #veggies-header { background-color: var(--veggies-color); }
    #grocery-header { background-color: var(--grocery-color); }
    #indian-header  { background-color: var(--indian-color); }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    tr {
      transition: all 0.3s ease;
      border-bottom: 1px solid #eee;
      touch-action: pan-y;
    }

    tr.checked {
      text-decoration: line-through;
      opacity: 0.5;
      color: #aaa;
    }

    td {
      padding: 15px;
    }

    .row-content {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: space-between;
    }

    .row-left {
      display: flex;
      gap: 10px;
      align-items: center;
      flex: 1;
    }

    .row-checkbox {
      width: 24px;
      height: 24px;
      appearance: none;
      border: 2px solid #666;
      border-radius: 4px;
      cursor: pointer;
    }

    .row-checkbox:checked {
      background-color: #666;
      border-color: #666;
    }

    .row-checkbox:checked::after {
      content: "‚úì";
      color: white;
      font-size: 16px;
      position: relative;
      left: 4px;
    }

    .item-name {
      border: none;
      background: transparent;
      outline: none;
      font-size: 1.3rem;
      flex: 1;
    }

    .highlight {
      font-weight: bold;
      color: #d32f2f;
      background-color: #fff3cd;
      padding: 2px 6px;
      border-radius: 4px;
    }

    .counter {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .counter-btn {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      border: none;
      color: white;
      background-color: #999;
      font-weight: bold;
      font-size: 1.32rem;
      cursor: pointer;
    }

    .counter-value {
      min-width: 28px;
      text-align: center;
      font-size: 1.3rem;
    }

    .add-row {
      text-align: right;
      padding: 10px 15px;
    }

    .add-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      color: white;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
    }

    #veggies-add { background-color: var(--veggies-color); }
    #grocery-add { background-color: var(--grocery-color); }
    #indian-add  { background-color: var(--indian-color); }

    .master-reset, .share-button {
      position: fixed;
      top: 10px;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background-color: var(--master-check-color);
      color: white;
      border: none;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 100;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    .master-reset { right: 15px; }
    .share-button { left: 15px; }

    .undo-toast {
      position: fixed;
      bottom: 15px;
      left: 50%;
      transform: translateX(-50%);
      background: #323232;
      color: white;
      padding: 10px 20px;
      border-radius: 6px;
      display: none;
      align-items: center;
      gap: 10px;
      z-index: 999;
    }

    .undo-toast button {
      background: none;
      border: none;
      color: #4caf50;
      cursor: pointer;
      font-weight: bold;
    }

    @media (max-width: 600px) {
      body {
        padding-top: 60px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>

  <button class="share-button" onclick="shareList()" title="Share">üì§</button>
  <button class="master-reset" onclick="resetAll()" title="Reset">‚ôªÔ∏è</button>
  <h1>My Grocery Lists</h1>

  <div id="toast" class="undo-toast">
    <span>Item deleted</span>
    <button onclick="undoDelete()">UNDO</button>
  </div>

  <div id="veggies" class="table-container">
    <div class="table-header" onclick="toggleTable('veggies')">Veggies <span>‚ñº</span></div>
    <table><tbody id="veggies-items"></tbody></table>
    <div class="add-row"><button class="add-btn" id="veggies-add" onclick="addRow('veggies')">+</button></div>
  </div>

  <div id="grocery" class="table-container">
    <div class="table-header" onclick="toggleTable('grocery')">Grocery <span>‚ñº</span></div>
    <table><tbody id="grocery-items"></tbody></table>
    <div class="add-row"><button class="add-btn" id="grocery-add" onclick="addRow('grocery')">+</button></div>
  </div>

  <div id="indian" class="table-container">
    <div class="table-header" onclick="toggleTable('indian')">Indian Store <span>‚ñº</span></div>
    <table><tbody id="indian-items"></tbody></table>
    <div class="add-row"><button class="add-btn" id="indian-add" onclick="addRow('indian')">+</button></div>
  </div>

  <script>
    const tables = {
      veggies: 'veggies-items',
      grocery: 'grocery-items',
      indian: 'indian-items'
    };

    const defaultItems = {
      veggies: ["‡§ü‡§Æ‡§æ‡§ü‡§∞", "Avocado", "Pears", "‡§Ö‡§¶‡§∞‡§ï", "‡§ï‡§¶‡•ç‡§¶‡•Ç"],
      grocery: ["Bin bags", "Bread", "Chicken", "Eggs", "Pizza Cheese"],
      indian: ["‡§Ü‡§ü‡§æ", "‡§ö‡§æ‡§µ‡§≤", "‡§™‡•ã‡§π‡§æ", "‡§¶‡§æ‡§≤:", "‡§¨‡•á‡§∏‡§®"]
    };

    let deletedItem = null;

    document.addEventListener('DOMContentLoaded', () => {
      for (const tableName in tables) {
        if (!localStorage.getItem(tableName)) {
          localStorage.setItem(tableName, JSON.stringify(defaultItems[tableName].map(name => ({
            name, checked: false, count: 0
          }))));
        }
        loadTable(tableName);
      }
    });

    function addRow(table) {
      const row = { name: '', checked: false, count: 0 };
      const data = getData(table);
      data.push(row);
      saveData(table, data);
      loadTable(table);
    }

    function toggleRow(index, table) {
      const data = getData(table);
      data[index].checked = !data[index].checked;
      saveData(table, data);
      loadTable(table);
    }

    function changeCount(index, table, delta) {
      const data = getData(table);
      data[index].count = Math.max(0, Math.min(50, data[index].count + delta));
      saveData(table, data);
      loadTable(table);
    }

    function deleteRow(index, table) {
      const data = getData(table);
      deletedItem = { table, item: data[index], index };
      data.splice(index, 1);
      saveData(table, data);
      loadTable(table);
      showToast();
    }

    function undoDelete() {
      if (!deletedItem) return;
      const data = getData(deletedItem.table);
      data.splice(deletedItem.index, 0, deletedItem.item);
      saveData(deletedItem.table, data);
      loadTable(deletedItem.table);
      deletedItem = null;
      hideToast();
    }

    function toggleTable(table) {
      const tbody = document.getElementById(tables[table]);
      tbody.style.display = tbody.style.display === 'none' ? '' : 'none';
    }

    function resetAll() {
      if (!confirm("Reset all counters and checkboxes?")) return;
      for (const tableName in tables) {
        const data = getData(tableName).map(item => ({ ...item, checked: false, count: 0 }));
        saveData(tableName, data);
        document.getElementById(tables[tableName]).style.display = '';
        loadTable(tableName);
      }
    }

    function shareList() {
      let msg = "üõí *My Grocery List*:\n\n";
      for (const table in tables) {
        msg += `*${table.charAt(0).toUpperCase() + table.slice(1)}:*\n`;
        getData(table).forEach(item => {
          if (item.count > 0 || item.checked)
            msg += `- ${item.name} (${item.count}) ${item.checked ? '‚úîÔ∏è' : ''}\n`;
        });
        msg += "\n";
      }
      const url = `https://wa.me/?text=${encodeURIComponent(msg)}`;
      window.open(url, '_blank');
    }

    function getData(table) {
      return JSON.parse(localStorage.getItem(table)) || [];
    }

    function saveData(table, data) {
      localStorage.setItem(table, JSON.stringify(data));
    }

    function loadTable(table) {
      const data = getData(table);
      const tbody = document.getElementById(tables[table]);
      tbody.innerHTML = '';
      data.forEach((item, i) => {
        const row = document.createElement('tr');
        if (item.checked) row.classList.add('checked');
        row.innerHTML = `
          <td>
            <div class="row-content" ontouchstart="this.startX=event.touches[0].clientX" ontouchend="if(this.startX-event.changedTouches[0].clientX>50) deleteRow(${i}, '${table}')">
              <div class="row-left">
                <input type="checkbox" class="row-checkbox" ${item.checked ? 'checked' : ''} onchange="toggleRow(${i}, '${table}')">
                <input type="text" class="item-name ${item.count > 0 ? 'highlight' : ''}" value="${item.name}" onchange="getData('${table}')[${i}].name=this.value;saveData('${table}', getData('${table}'));loadTable('${table}')">
              </div>
              <div class="counter">
                <button onclick="changeCount(${i}, '${table}', -1)">-</button>
                <span class="counter-value">${item.count}</span>
                <button onclick="changeCount(${i}, '${table}', 1)">+</button>
              </div>
            </div>
          </td>
        `;
        tbody.appendChild(row);
      });
    }

    function showToast() {
      const toast = document.getElementById("toast");
      toast.style.display = "flex";
      setTimeout(hideToast, 5000);
    }

    function hideToast() {
      document.getElementById("toast").style.display = "none";
    }
  </script>
</body>
</html>
